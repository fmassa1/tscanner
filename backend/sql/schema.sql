CREATE DATABASE IF NOT EXISTS tscrapper;
USE tscrapper;


DROP TABLE IF EXISTS comments;
DROP TABLE IF EXISTS posts;
DROP TABLE IF EXISTS users;

CREATE TABLE users (
    url VARCHAR(255) NOT NULL UNIQUE,
    username VARCHAR(100) NOT NULL PRIMARY KEY,
    id VARCHAR(100) NOT NULL UNIQUE,
    flags INT DEFAULT 0
)ENGINE=InnoDB;

CREATE TABLE posts (
    url VARCHAR(255) NOT NULL PRIMARY KEY,
    title VARCHAR(300) NOT NULL,
    author VARCHAR(100) NOT NULL,
    body TEXT NOT NULL,
    comments INT DEFAULT 0,
    ups INT DEFAULT 0,
    created_on TIMESTAMP NOT NULL,
    post_id VARCHAR(255) NOT NULL,
    subreddit VARCHAR(255) NOT NULL,
    FOREIGN KEY (author) REFERENCES users(username) ON DELETE CASCADE

)ENGINE=InnoDB;

CREATE TABLE comments (
    post_id VARCHAR(255) NOT NULL,
    parent_id VARCHAR(100) NOT NULL,
    author VARCHAR(100) NOT NULL,
    body TEXT NOT NULL,
    url VARCHAR(255) NOT NULL PRIMARY KEY,
    ups INT DEFAULT 0,
    created_on TIMESTAMP NOT NULL,
    subreddit VARCHAR(255) NOT NULL,
    FOREIGN KEY (author) REFERENCES users(username) ON DELETE CASCADE
    -- FOREIGN KEY (post_id) REFERENCES posts(post_id) ON DELETE CASCADE
)ENGINE=InnoDB;

CREATE TABLE subreddits (
    url VARCHAR(255) NOT NULL UNIQUE,
    name VARCHAR(100) NOT NULL PRIMARY KEY,
    flags INT DEFAULT 0
)ENGINE=InnoDB;